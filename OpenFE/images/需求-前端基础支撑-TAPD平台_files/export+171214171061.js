function click_export(e){var t=$(e).attr("is-disable"),o=$(e).attr("enable-select-fields"),i=$(e).attr("export-url"),n=$(e).attr("export-dialog-url"),a=$(e).attr("enable-checkbox-export"),r=$(e).attr("export-token");return"disabled"==t?!0:void(o?o&&!a?check_export_email(r,function(){show_export_fields_dialog(n)}):o&&a&&syncSaveCheckedIdsAndShowExportFieldsDialog(n):window.location.href=i)}function check_export_email(e,t){var o=_base+_workspace_id+"/exports/check_export_email/"+e;$.get(o,function(e){if("1"==e)t();else if("ASYNC_NO_EMAIL"==e){var o=_base+"personal_settings/index";TFL.tips.showFlash('导出的数据将通过邮件形式发送给您，请先<a href="'+o+'" target="_blank">设置邮箱</a>再重新操作')}})}function syncSaveCheckedIdsAndShowExportFieldsDialog(e){var t=$("td.flag_area :checkbox:not('#chkAll_show_my_view'):checked"),o="";t.length>0&&$.each(t,function(e,t){o+=$(t).attr("value")+","}),$.ajax({type:"POST",url:syncSaveCheckedIdsAndShowExportFieldsDialogUrl,data:"sj="+Math.random()+"&ids="+o.substr(0,o.length-1),success:function(t){if("1"==t)show_export_fields_dialog(e);else if("ASYNC_NO_EMAIL"==t){var o=_base+"personal_settings/index";TFL.tips.showFlash('导出的数据将通过邮件形式发送给您，请先<a href="'+o+'" target="_blank">设置邮箱</a>再重新操作')}}})}function show_export_fields_dialog(e){TFL.dialog.show({title:showExportFieldsDialogTitle,url:e,useIframe:!0,fullscreen:!1,dataBtn:confirmBtnTip+"`.btn-primary`:select_field_yes,"+cancelBtnTip+":select_field_no"})}function exportXls(e,t){if(e)var o=exportUrlWithToken+e+exportRandom;else var o=exportUrlWithoutToken;/SE\s\.?/.test(navigator.userAgent)?$.get(o+"&no_redirect=1",function(e){if(e||TFL.tips.showFlash("导出失败"),e.download_url){var t=e.download_url,o=$("iframe");o.attr("src",t+"&do_not_delete=1"),o.css("display","none"),$("body").append(o),setTimeout(function(){$.get(t,function(e){o.remove()})},6e4)}else e.reload_url&&(window.location.href=e.reload_url)},"json"):window.location.href=o,hide_preload()}function bindInputClick(){$("body").delegate("input[type=checkbox]","click",function(){check_num=0;$(this);$("input[type=checkbox]").each(function(){1==$(this).attr("checked")&&check_num++}),check_num>0?($("#export_dropdown_link").attr("is-disable",""),$("#export_dropdown_link").attr("class",btnClass),$("#export_dropdown_link").attr("title","")):($("#export_dropdown_link").attr("is-disable",isDisable),$("#export_dropdown_link").attr("class",btnClass+" "+isDisable),$("#export_dropdown_link").attr("title",tip))})}