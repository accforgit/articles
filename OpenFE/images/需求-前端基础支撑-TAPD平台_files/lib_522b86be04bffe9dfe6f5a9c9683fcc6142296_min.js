!function(b,c){c&&(b=window.location.protocol+"//js.tapd.cn/"),TFL.add("topnav",{path:b+"js/topnav.js"}),TFL.add("header",{path:b+"js/header.js"}),TFL.add("leftTree",{path:b+"js/left_tree.js"}),TFL.add("DialogCreateWorkspace",{path:b+"js/dialog_create_workspace.js"}),TFL.add("search",{path:b+"js/search.js"}),TFL.add("SetFavorite",{path:b+"js/set_favorite.js"}),TFL.add("TestPlanAdd",{path:b+"js/sparrow/test_plan_add.js",requires:["URLParser"]}),TFL.add("TestPlanAddV2",{path:b+"js/sparrow/test_plan_add_v2.js",requires:["URLParser"]}),TFL.add("TestPlanEditV2",{path:b+"js/sparrow/test_plan_add_v2.js",requires:["URLParser"]}),TFL.add("TestPlanEdit",{path:b+"js/sparrow/test_plan_add.js",requires:["URLParser"]}),TFL.add("TcaseAdd",{path:b+"js/sparrow/tcase_add.js",requires:["FormChangeTips"]}),TFL.add("TcaseAddV2",{path:b+"js/sparrow/tcase_add_v2.js",requires:["FormChangeTips"]}),TFL.add("TcaseEditV2",{path:b+"js/sparrow/tcase_add_v2.js",requires:["FormChangeTips"]}),TFL.add("TcaseQuickManage",{path:b+"js/sparrow/tcase_quick_manage.js",requires:["TcaseAdd","CategoryParentDialog"]}),TFL.add("TcaseQuickManageHebe",{path:b+"js/sparrow/tcase_quick_manage_hebe.js",requires:["TcaseAdd","CategoryParentDialog"]}),TFL.add("TcaseEdit",{path:b+"js/sparrow/tcase_add.js",requires:["FormChangeTips"]}),TFL.add("TcaseList",{path:b+"js/sparrow/tcase_list.js"}),TFL.add("Validater",{path:b+"js/tfl_validate.js"}),TFL.add("CategoryParentDialog",{path:b+"js/category.js",requires:["ZTree","ZTreeExedit"]}),TFL.add("KDialog",{path:b+"js/tfl_kdialog.js",requires:["TapdFilter"]}),TFL.add("KDialog.frame",{path:b+"js/tfl_kdialog.js",requires:["TapdFilter"]}),TFL.add("KDialog.SelectedList",{path:b+"js/tfl_kdialog.js",requires:["TapdFilter"]}),TFL.add("WorktableCounting",{path:b+"js/worktable_counting.js"}),TFL.add("TreeTable",{path:b+"js/sparrow/tree_table.js"}),TFL.add("TcaseExecute",{path:b+"js/sparrow/tcase_execute.js",requires:["CustomDialog"]}),TFL.add("CustomDialog",{path:b+"js/sparrow/custom_dialog.js"}),TFL.add("PlanExecute",{path:b+"js/sparrow/plan_execute.js"}),TFL.add("TcaseResult",{path:b+"js/sparrow/tcase_result.js",requires:["CustomDialog"]}),TFL.add("TapdFilter",{path:b+"js/tapd_filter.js",requires:["URLParser"]}),TFL.add("URLParser",{path:b+"js/jquery.url.js"}),TFL.add("Util",{path:b+"js/lib.js"}),TFL.add("JqueryTreeViewJs",{path:b+"js/jquery.treeview.min.js"}),TFL.add("tcasePreview",{path:b+"js/sparrow/tcase_preview.js"}),TFL.add("WorkspaceReport.Workitems",{path:b+"js/report/report_workitems.js"}),TFL.add("WorkspaceReport.ChooseWorkitems",{path:b+"js/report/choose_workitem.js",requires:["WorkspaceReport.Workitems"]}),TFL.add("TestPlanDetail",{path:b+"js/sparrow/test_plan_detail.js",requires:["CustomDialog","URLParser"]}),TFL.add("TestPlanDetailV2",{path:b+"js/sparrow/test_plan_detail_v2.js",requires:["CustomDialog","URLParser"]}),TFL.add("TcaseBug",{path:b+"js/sparrow/tcase_bug.js"}),TFL.add("guide",{path:b+"js/guide.js"}),TFL.add("CommonTemplage",{path:b+"js/common_templage.js"}),TFL.add("FormChangeTips",{path:b+"js/form_change_tips.js"}),TFL.add("StatusTransferValidate",{path:b+"js/status_transfer_validate.js"}),TFL.add("StatusTransferValidateBug",{path:b+"js/status_transfer_validate_bug.js"}),TFL.add("TapdValidate",{path:b+"js/tfl_tapd_validate.js"}),TFL.add("ZTree",{path:b+"js/ztree/jquery.ztree.core-3.5.js",requires:["ZTree-css"]}),TFL.add("ZTreeCheckbox",{path:b+"js/ztree/jquery.ztree.excheck-3.5.js"}),TFL.add("ZTreeExedit",{path:b+"js/ztree/jquery.ztree.exedit-3.5.js",requires:["ZTree"]}),TFL.add("ShortcutTool",{path:b+"js/shortcut_tool.js"}),TFL.add("WorktableCommonJs",{path:b+"js/worktable/common.js"}),TFL.add("ddupload",{path:b+"js/tfl_ddupload.js",requires:["progress"]}),TFL.add("PlanViewUpload",{path:b+"js/plan_view_upload.js",requires:["ddupload"]}),TFL.add("newPlanViewUpload",{path:b+"js/new_plan_view_upload.js",requires:["ddupload"]}),TFL.add("CardViewUpload",{path:b+"js/board/card_view_upload.js",requires:["ddupload"]}),TFL.add("ZTree-css",{path:b+"css/ztree/zTreeStyle.css"}),TFL.add("WorkspaceChooser",{path:b+"js/workspaceChooser.js",requires:["ZTree","ZTree-css"]}),TFL.add("TreeChooser-css",{path:b+"css/treechooser.css"}),TFL.add("TreeChooser-css-hebe",{path:b+"css/treechooser_hebe.css"}),TFL.add("TreeChooser",{path:b+"js/treechooser.js",requires:["ZTree","TreeChooser-css"]}),TFL.add("TreeChooser-hebe",{path:b+"js/treechooser-hebe.js",requires:["ZTree","TreeChooser-css-hebe"]}),TFL.add("TreeChooserExcheck",{path:b+"js/ztree/jquery.ztree.excheck-3.5.min.js",requires:["ZTree"]}),TFL.add("JqueryValidate",{path:b+"js/jquery.validate.js"}),TFL.add("TflValidateTapd",{path:b+"js/tfl-validate-tapd.js",requires:["validate","localData"]}),TFL.add("CategoryZtree",{path:b+"js/category_ztree.js",requires:["ZTreeExedit","URLParser"]}),TFL.add("JPlayer-css",{path:b+"css/jplayer/jplayer.tapd.css"}),TFL.add("JPlayer",{path:b+"js/jplayer/jquery.jplayer.min.js",requires:["JPlayer-css"]}),TFL.add("progress",{path:b+"js/progress.js"}),TFL.add("UserAccess",{path:b+"js/tfl_user_access.js",requires:["localData"]}),TFL.add("StoryCustomStatistic",{path:b+"js/story_custom_statistic.js",requires:["dialog"]}),TFL.add("Watermark",{path:b+"js/jquery.watermark.min.js"}),TFL.add("MobileSmsVerify-css",{path:b+"css/tcloud/mobile_sms_verify.css"}),TFL.add("MobileSmsVerify",{path:b+"js/tcloud/mobile_sms_verify.js",requires:["MobileSmsVerify-css"]}),TFL.add("HeaderFloat",{path:b+"js/headerfloat.js"}),TFL.add("BoardPublicBoardItemRecord",{path:b+"js/board/public-board-item-record.js"}),TFL.add("BoardPublicUrlAction",{path:b+"js/board/public-url-action.js"}),TFL.add("BoardPublicDataHelper",{path:b+"js/board/public-data-helper.js"}),TFL.add("BoardPublicEditing",{path:b+"js/board/public-editing.js"}),TFL.add("BoardPublicCardAction",{path:b+"js/board/public-card-action.js"}),TFL.add("BoardPublicScrollbarCtrl",{path:b+"js/board/public-scrollbar-ctrl.js"}),TFL.add("BoardPublicBoardAction",{path:b+"js/board/public-board-action.js"}),TFL.add("BoardPublicCardDetailAction",{path:b+"js/board/public-card-detail-action.js"}),TFL.add("BoardPublicCardDetailMask",{path:b+"js/board/public-card-detail-mask.js"}),TFL.add("BoardPublicShortcutAction",{path:b+"js/board/public-shortcut-action.js"}),TFL.add("BoardPublic",{path:b+"js/board/board_detail_public.js",requires:["BoardPublicBoardItemRecord","BoardPublicUrlAction","BoardPublicDataHelper","BoardPublicEditing","BoardPublicCardAction","BoardPublicScrollbarCtrl","BoardPublicBoardAction","BoardPublicCardDetailAction","BoardPublicCardDetailMask","BoardPublicShortcutAction"]}),TFL.add("BoardJs",{path:b+"js/board/board.js",requires:["BoardPublic"]}),TFL.add("WorktableBoardJs",{path:b+"js/worktable/board.js",requires:["BoardPublic"]}),TFL.add("TcaseCustomizeSort",{path:b+"js/sparrow/tcase_customize_sort.js"}),TFL.add("phoneVerify",{path:b+"js/tcloud/phone_number_verify.js",requires:["MobileSmsVerify-css"]}),TFL.add("advancedFilter",{path:b+"js/tcloud/advanced-search-filter.js",requires:["tSelect",{path:b+"css/tcloud/advanced-search-filter.css"},{path:b+"template/advanced-search-filter.art"}]})}(_base,cdn_enabled);function $G(a){return document.getElementById?document.getElementById(a):null}function getNewDate(a){return a=a.replace(/\-/g,"/"),new Date(a)}function getAncestorByTagName(b,a){a=a.toLowerCase();do{b=b.parentNode}while(1==b.nodeType&&b.tagName.toLowerCase()!=a);return 1==b.nodeType?b:null}function getQueryArray(h,k){var j=k||document.location.search;if(!j||-1==j.indexOf("?")){return{}}var g=j.substr(j.indexOf("?")+1),d=g.split("&"),h=void 0===h?!0:h,b={};for(var c in d){var f=d[c].split("=");if(!(f.length<2)){var m=decodeURIComponent(f[1].replace(/\+/g," "));(m||h)&&(b[decodeURIComponent(f[0])]=m)}}return b}function getQueryValue(f,d){var b=d||document.location.search;if(!b||!f){return""}var c=new RegExp("[\\?&]"+encodeURIComponent(f)+"=[^&#]+","g"),g=b.match(c);return g?decodeURIComponent(g.pop().substr(1).split("=")[1].replace(/\+/g," ")):""}function searchHighlight(){function f(p){if(-1==p.indexOf("?")){return[]}var j=p.substr(p.indexOf("?")+1),i=j.split("&");for(var u in i){var m=i[u].split("=");if(!(m.length<2||"q"!=m[0]&&"p"!=m[0])){var q=decodeURIComponent(m[1].replace(/\+/g," "));"!"==q[0]&&(q=q.slice(1)),c=q.split(/(".*?")|('.*?')|(\s+)/);var h=new Array;for(var k in c){c[k]=c[k].replace(/^\s+$/,""),""!=c[k]&&h.push(c[k].replace(/^['"]/,"").replace(/['"]$/,""))}return h}}return[]}function d(l,h,j){if(3==l.nodeType){var p=l.nodeValue.toLowerCase().indexOf(h.toLowerCase());if(p>=0&&!/^searchword\d$/.test(l.parentNode.className)){var k=document.createElement("span");return k.className="searchword"+j%5,k.appendChild(document.createTextNode(l.nodeValue.substr(p,h.length))),l.parentNode.insertBefore(k,l.parentNode.insertBefore(document.createTextNode(l.nodeValue.substr(p+h.length)),l.nextSibling)),l.nodeValue=l.nodeValue.substr(0,p),!0}}else{if(!l.nodeName.match(/button|select|textarea/i)){for(var m=0;m<l.childNodes.length;m++){d(l.childNodes[m],h,j)&&m++}}}return !1}if(document.createElement){var b=document.getElementById("searchable");if(b){var c=f(document.URL);if(c.length||(c=f(document.referrer)),c.length){for(var g in c){c[g].length&&d(b,c[g],g)}}}}}function enableControl(g,d){"undefined"==typeof d&&(d=!0);var b=document.getElementById(g);if(b){b.disabled=!d;var c=getAncestorByTagName(b,"label");if(c){c.className=d?"enabled":"disabled"}else{for(var h=document.getElementsByTagName("label"),f=0;f<h.length;f++){if(h[f].htmlFor==g){h[f].className=d?"enabled":"disabled";break}}}}}function trans(a){document.getElementById("selectedSource").innerHTML=a.innerHTML,document.getElementById("LocaleSourceId").value=a.getAttribute("sourceid"),document.getElementById("LocaleTargetId").value=a.getAttribute("targetid"),document.getElementById("LocaleTargetTranslation").value=a.getAttribute("translation"),document.getElementById("LocaleTargetLocaleId").value=a.getAttribute("locale_id"),document.getElementById("localetrans").style.display="",document.getElementById("LocaleTargetTranslation").focus()}function updatecontrollerstatus(){$("input[controller=self]").each(function(){var b=this,a=!0;$(b).parent().find("input").each(function(){a=a&&this.checked}),a?$(b).parent().children(".controller").removeClass("notall"):$(b).parent().children(".controller").addClass("notall")})}function checkcontrolleractions(f){var d=f.getAttribute("controller"),b=f.checked;if("self"==d){d=f.value,$("input[controller="+d+"]").each(function(){$(this).attr("checked",f.checked)}),f.checked?$(f).parent().children(".controller").removeClass("notall"):$(f).parent().children(".controller").addClass("notall")}else{var c=!0;$("input[controller="+d+"]").each(function(){c=c&&this.checked==b});var g=$("input[value="+d+"]");c?(g.attr("checked",b),b&&g.parent().children(".controller").removeClass("notall")):(g.attr("checked",!0),g.parent().children(".controller").addClass("notall"))}}function toggleDisplay(a){$(a).swapClass("expandable","collapsable"),$(a).parent().find(">ul").toggle()}function collapseAll(a){$(a).find("div.hitarea").replaceClass("collapsable","expandable"),$(a).find("div.hitarea").parent().find(">ul").hide()}function expandAll(a){$(a).find("div.hitarea").replaceClass("expandable","collapsable"),$(a).find("div.hitarea").parent().find(">ul").show()}function update_left_menu(){window.top.left&&(window.top.left.location.href=window.top.left.location.href)}function fCheckPicutreType(f){var d=document.getElementById(f),b=d.value.split("."),c=b[b.length-1],g=/jpg|gif|png|bmp$/i;return g.test(c)?!0:(alert("只允许上传jpg、gif、png、bmp图片!"),!1)}function fCheckFileType(f){var d=document.getElementById(f),b=d.value.split("."),c=b[b.length-1],g=/doc|docx$/i;return g.test(c)?!0:(alert("只允许上传doc文件!"),!1)}function initIntegerInput(a){$("input[intinput]").keydown(function(c){var b=c.keyCode;b>=48&&57>=b||b>=96&&105>=b||b>=37&&40>=b||8==b||9==b||46==b||35==b||36==b||109==b||17==b||189==b&&!a||c.ctrlKey&&(67==b||86==b)||(c.preventDefault?c.preventDefault():c.keyCode=0,c.returnValue=!1,c.cancelBubble=!0)})}function initPositiveInt(a){initIntegerInput(a),$("input[intinput]").on("keyup",function(){var b=$(this).val();$(this).val(b.replace(/[^\d]/g,"")),b.length>1&&"0"==b[0]&&$(this).val(b.substring(1))}),$("input[intinput]").each(function(){this.onpaste=function(){return !1}})}function ieFormErrorFix(){jQuery.browser.msie&&$("select.form_error").wrap('<span class="form_error"></span>')}function showsubworkspaces(){$("#divSubWorkspaces").attr("left",$(this).attr("scrollLeft")),$("#divSubWorkspaces").slideDown(),$(document.body).click(function(){$("#divSubWorkspaces").hide()})}function deleteObj(b,a){confirm(a)&&(window.location=b+"?ref="+document.URL)}function reflash(){window.location.reload()}function parseQuery(h){var f=h.replace(/^[^\?]+\??/,"");f||(f=h.replace(/^[^\&]+\&?/,""));var c={};if(!f){return c}for(var d=f.split(/[;&]/),k=0;k<d.length;k++){var g=d[k].split("=");if(g&&2==g.length){var j=unescape(g[0]),b=unescape(g[1]);b=b.replace(/\+/g," "),c[j]=b}}return c}function prevent_reduplicate_submit(d){var c=$("#deal_dump_submit_button").length,b=document.createElement("input");return b.id="deal_dump_submit_button",b.name=$(d).attr("name"),b.value=$(d).attr("value"),b.type="button",b.disabled="true",$(d).before(b),class_name=$(d).attr("class"),(""!=class_name||"undefined"!=class_name)&&$("#deal_dump_submit_button").addClass(class_name),$(d).hide(),c>0?!1:!0}function onGoTo(b,a){var a=arguments[1]?arguments[1]:"_self";"object"==typeof tapd_dsc&&tapd_dsc.add_dsc_to_form("onhref"),$("#onhref").attr("action",b).attr("target",a).submit()}function loadJsFile(h,f,c){var d=c||document;if(f){for(var k=GelTags("script",d),g=k.length-1;g>=0;g--){if(-1!=k[g].src.indexOf(h)){return}}}var j=d.createElement("script"),b=GelTags("head",d)[0]||d.documentElement;return j.type="text/javascript",j.src=h,j.setAttribute("async",!0),b.appendChild(j),j}function loadCssFile(h,k,j){var g=j||document;if(k){for(var d=GelTags("link",g),b=d.length-1;b>=0;b--){if(-1!=d[b].href.indexOf(h)){return}}}var c=g.createElement("link"),f=GelTags("link",g);if(c.type="text/css",c.rel="stylesheet",c.href=h,f.length>0){var m=f[f.length-1];m.parentNode.insertBefore(c,m.nextSibling)}else{(GelTags("head",g)[0]||g.documentElement).appendChild(c)}return c}function GelTags(b,a){return(a||document).getElementsByTagName(b)}function is_scroll(){return document.body.scrollWidth-$(window).width()>0}function iframe_download(b){0<$("#iframe_for_down").length&&$("#iframe_for_down").remove();var a=document.createElement("iframe");a.src=b+"?r="+Math.random(),a.id="iframe_for_down",a.className="iframe_for_downing",a.style.display="none",document.body.appendChild(a),a.onload=function(){hide_preload()}}function isNumber(b){var a=b;return a.search(/^[+-]?[0-9.]*$/)>=0}function isEmptyHtmlEditor(d){if($("#editor-"+d).length){return TFL.editor.getInstance(d).isEmpty()}var c,b=!1;return c="undefined"!=typeof GetContent?GetContent():$.trim(qmEditor.getEditor(d).getContent()),(""==c||"<p>&nbsp;</p>"==c.toLowerCase()||"<div>&nbsp;</div>"==c.toLowerCase().replace(/\s$/,"")||"<br>"==c.toLowerCase()||"<div><br></div>"==c.toLowerCase())&&(b=!0),b}function get_richeditor_content(b){var a="";if(TFL.editor&&TFL.editor.getInstance(b)){var a=TFL.editor.getInstance(b).html()}else{if("undefined"==typeof GetContent){var a=qmEditor.getEditor(b+"Editor").getContent()}else{var a=GetContent()}}return a}function preg_quote(a){return(a+"").replace(/([\.\\\\/+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:\-])/g,"\\$1")}function htmlspecialchars_decode(b){var a={"&amp;":"&","&#37;":"%","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#40;":"(","&#41;":")","&#43;":"+","&#45;":"-","&#92;":"\\"};return b.replace(/&amp;|&#37;|&lt;|&gt;|&quot;|&#39;|&#40;|&#41;|&#43;|&#45;|&#92;/gi,function(c){return a[c]})}function htmlspecialchars_encode(b){var a={"&":"&amp;","%":"&#37;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","(":"&#40;",")":"&#41;","+":"&#43;","-":"&#45;","\\":"&#92;"};return b.replace(/&|%|<|>|"|'|\(|\)|\+|-|\\/gi,function(c){return a[c]})}function valiDateTime(f){if(""==f){return !0}var d=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,b=f.match(d);if(null==b){return !1}b[2]=b[2]-1;var c=new Date(b[1],b[2],b[3]);return c.getFullYear()!=b[1]?!1:c.getMonth()!=b[2]?!1:c.getDate()!=b[3]?!1:!0}function show_load_indicator(){$("#load-indicator").show()}function hide_load_indicator(){$("#load-indicator").hide()}function hide_drop_menu(){TFL.dropdown.clearMenus()}function reloadPageAfterFlash(f,d){TFL.tips.showFlash(f);var b=d?d:3000,c=setTimeout(function(){window.location.reload()},b);$(document).delegate("#flash_message a","click",function(){clearTimeout(c)})}function locationPageAfterFlash(f,d,b){TFL.tips.showFlash(f);var c=d?d:3000,g=setTimeout(function(){window.location.href=b},c);$(document).delegate("#flash_message a","click",function(){clearTimeout(g)})}function init_date_input(){}function do_date_Picker(a){TFL.use("uiDatepicker",function(){TFL.datepicker._config(a).datepicker("show").removeAttr("onfocus").removeClass("tapd-new-date")})}function tapd_tb_show(f,d,b,c,g){TFL.dialog.show({title:f,url:d,useIframe:b,dataBtn:c,fullscreen:g})}function tapd_tb_remove(f,d,b,c){TFL.dialog.close(f,d,b,c)}function my_tapd_tb_show(g){var d=$(g),b=d.attr("title")||d.attr("name")||"",c=d.attr("href")||d.attr("url"),j="false"==d.attr("useiframe")?!1:!0,f=d.attr("btns")||"",h=TFL.tagBoolean("fullscreen",d,!0);return TFL.dialog.show({title:b,url:c,useIframe:j,dataBtn:f,fullscreen:h}),d.blur(),!1}function tapd_tb_init(){}function init_tapdbox(){}function show_flash_message(a){TFL.tips.showFlash(a)}function show_preload(a){TFL.tips.showPreload(a)}function hide_preload(){TFL.tips.hidePreload()}function setPageConfigPosition(){if(!$("#filter_button").length){return !1}var d=$("#page-content"),c="filter-section-open",b="filter-section-close";$("div.filter-panel:visible").length||$("div.query_results_box:visible").length?d.addClass(c).removeClass(b):d.addClass(b).removeClass(c)}function simplePager(){$(".page-select li a").click(function(){var a=$(this).text();$(this).closest("li").addClass("current").siblings().removeClass("current"),$(this).closest(".page-select").find(".current-page").text(a)}),$("body").bind("dropdownopen",function(f){var d=$(f.target);if(d.hasClass("page-select")){var b=d.find("ul"),c=d.find("li.current");c.length&&(c.prev().length&&(c=c.prev()),b.scrollTop(0).scrollTop(c.position().top))}})}function dropAnchor(b){var a="modified_item_tr";$("body").delegate(b,"mousedown",function(c){$(this).closest("table").find("tr."+a).removeClass(a);$(c.target).closest("tr").addClass(a).attr("id")})}function fixZindex(d){var c=$(d);if(!$("html.ie7").length||!c.length){return !1}var b=c.css("z-index");c.bind("dropdownclose",function(){$(this).css({"z-index":b})}).bind("dropdownopen",function(){$(this).css({"z-index":999})})}function scrollingTag(b,a){$(window).scroll(function(){$(window).scrollTop()>b?$("body").addClass(a):$("body").removeClass(a)})}function responseMenu(f,d){function b(g,a){$("body").hasClass("left-tree-close")?offset=0:offset=200,$(window).width()-offset<g?$("body").addClass(a):$("body").removeClass(a),$(window).width()<1380?$("body").addClass("minwindow"):$("body").removeClass("minwindow"),$("body").trigger("menu_resize")}b(f,d),"undefined"==typeof TFL.timer.mediaTag&&(TFL.timer.mediaTag=[]);var c=TFL.timer.mediaTag.length;TFL.timer.mediaTag[c]=null,$(window).bind("resize",function(){clearTimeout(TFL.timer.mediaTag[c]),TFL.timer.mediaTag[c]=setTimeout(function(){b(f,d)},50)}),$(document).bind("leftTreeToOpen",function(){b(f,d)})}function isLego(){return"undefined"!=typeof tui_skin&&"lego"===tui_skin?!0:!1}function log(){if("undefined"==typeof isDev||"1"!==isDev){return !1}if("alert"===arguments[0]){return void alert(arguments[1])}if(window.console&&console.log){if(console.log.apply){console.log.apply(console,arguments)}else{var a=Array.prototype.splice.call(arguments,0,arguments.length);console.log(a.toString())}}else{alert(arguments[0])}}function tapdDevTool(){$(window).keydown(function(a){119==a.keyCode})}function simulatePlaceholder(f,d,b){if($.browser.msie){d=d?d:"输入标题",b=b?b:"";var c=$('<label data-type="'+b+'" for="'+f+'" class="placeholder hide">'+d+"</label>");$("#"+f).before(c).prettyPlaceHolder()}}function check_flash_plugin(){var h=navigator.plugins,f=!1,c=0,d=!1;try{var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");d=!0,k&&(f=!0,VSwf=k.GetVariable("$version"),c=parseInt(VSwf.split(" ")[1].split(",")[0]))}catch(g){if(h.length>0&&h["Shockwave Flash"]){f=!0;for(var k=navigator.plugins["Shockwave Flash"],j=k.description.split(" "),b=0;b<j.length;++b){isNaN(parseInt(j[b]))||(c=parseInt(j[b]))}}}return{f:f,v:c,ie:d}}function global_copy_data_function(d,c){$use_flash=!0,c=c?c:"已拷贝到剪切板";try{document.queryCommandSupported("copy")&&($use_flash=!1)}catch(b){}$use_flash?check_flash_plugin().f?TFL.use(_base+"js/ZeroClipboard2.0.0.js",function(){var e=new ZeroClipboard(d);e.on("ready",function(a){e.on("copy",function(g){var f=$($(g.target).attr("data-clipboard-target")).val();g.clipboardData.setData("text/plain",f)}),e.on("aftercopy",function(f){TFL.tips.showFlash(c)})}),e.on("error",function(a){ZeroClipboard.destroy()})}):d.click(function(){TFL.tips.showFlash("没有安装flash播放器")}):d.mouseover(function(){"1"!==d.attr("data-clipboard-init")&&(TFL.use(_base+"js/clipboard.js",function(){var e=new Clipboard(d[0]);e.on("success",function(a){a.clearSelection(),TFL.tips.showFlash(c)})}),d.attr("data-clipboard-init","1"))})}function int_validation_event(g,d){var b=g.keyCode||g.which||g.charCode;if(b>=48&&57>=b||b>=96&&105>=b||b>=37&&40>=b||8==b||9==b||46==b||35==b||36==b||189==b||109==b||17==b||g.ctrlKey&&(67==b||86==b)){}else{var c=$(d).attr("id"),h=c+"TipTemp",f=$("#"+h);if(0==f.size()){var f=$("<div></div>");f.attr("id",c+"TipTemp"),f.insertAfter($(d))}f.show(),f.text("只能输入整数！"),f.addClass("red"),setTimeout(function(){f.fadeOut()},1000),g.preventDefault?g.preventDefault():g.keyCode=0,g.returnValue=!1,g.cancelBubble=!0}}function float_validation_event(g,d){var b=g.keyCode||g.which||g.charCode;if(console.log(b),b>=48&&57>=b||b>=96&&105>=b||b>=37&&40>=b||8==b||9==b||46==b||35==b||36==b||189==b||109==b||17==b||g.ctrlKey&&(67==b||86==b)){}else{var c=$(d).attr("id");if((110==b||190==b)&&!/\./.test($("#"+c).val())){return""}var h=c+"TipTemp",f=$("#"+h);if(0==f.size()){var f=$("<div></div>");f.attr("id",c+"TipTemp"),f.insertAfter($(d))}f.show(),f.text("只能输入整数或小数！"),f.addClass("red"),setTimeout(function(){f.fadeOut()},1000),g.preventDefault?g.preventDefault():g.keyCode=0,g.returnValue=!1,g.cancelBubble=!0}}function init_Integer_Input(){$("input[intinput]").not("input[inited]").keydown(function(a){int_validation_event(a,$(this))}).keyup(function(a){$(this).val($(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).bind("paste",function(){return !1}),$("input[intinput]").not("input[inited]").attr("inited","true").attr("style","ime-mode:disabled")}function init_Floa_Input(){$("input[floatinput]").not("input[inited]").keydown(function(a){float_validation_event(a,$(this))}).keyup(function(a){$(this).val($(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).bind("paste",function(){return !1}),$("input[floatinput]").not("input[inited]").attr("inited","true").attr("style","ime-mode:disabled")}function replace_slash(b,a){return"undefined"==typeof a&&(a="@@@^^^@@@"),b=b.replace(/\//g,a)}function replace_plus(b,a){return"undefined"==typeof a&&(a="@@@***@@@"),b=b.replace(/\+/g,a)}function noH5Validate(){$("form").each(function(){this.noValidate=!0})}function disabledEnterSubmit(a){$(a).bind("keydown",function(b){return $(b.target).is("input[type=text]")&&13===b.keyCode?!1:void 0})}function inviteCheckbox(){var a=function(b){b.checked?$(b).parent().addClass("selected"):$(b).parent().removeClass("selected")};$("#invite_area input[type='checkbox'], #invite_ways input[type='checkbox']").each(function(){a(this)}),$("#invite_area input[type='checkbox'], #invite_ways input[type='checkbox']").click(function(){a(this)})}function user_avatar(f,d,b){var c="";if(d=d||_workspace_id||0,Date.prototype.toISOString||!function(){function a(i){var h=String(i);return 1===h.length&&(h="0"+h),h}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}}(),b=b||(new Date).toISOString().substr(0,10),c="string"==typeof f?f:"string"==typeof user_nick?user_nick:"",isCloud){var g="number"==typeof f?f:user_id;return _base+d+"/users/avatar/"+g+"?t="+b}return _base+d+"/users/avatar/"+c}function autofocus(){jQuery.browser.msie&&setTimeout(function(){$("input[autofocus]").focus()},1000)}function revocation_delete(h){var f;if($(h).attr("bug_ids")){f=$(h).attr("bug_ids"),type="bug"}else{if($(h).attr("story_ids")){f=$(h).attr("story_ids"),type="story"}else{if(!$(h).attr("task_ids")){return !1}f=$(h).attr("task_ids"),type="task"}}var c;switch(type){case"bug":c="/bugtrace/bugs";break;case"story":c="/prong/stories";break;case"task":c="/prong/tasks"}var d=!!$(h).attr("single_recover");if(f){var k=_base+_workspace_pretty_name+c+"/recover_delete";d&&(k+="/1");for(var g=f.split("-"),j={},b=0;b<g.length;b++){j[b]=g[b]}}TFL.tips.showPreload(),$.post(k,j,function(a){location.reload()})}function priority_call_back(f){var d,b=$(f).attr("data-editable-value"),c={"":"priority-label-empty","--":"priority-label-empty",Urgent:"priority-label-urgent",urgent:"priority-label-urgent",High:"priority-label-high",high:"priority-label-high",Middle:"priority-label-middle",middle:"priority-label-middle",medium:"priority-label-middle",Low:"priority-label-low",low:"priority-label-low","Nice To Have":"priority-label-nice-to-have","nice to have":"priority-label-nice-to-have",insignificant:"priority-label-nice-to-have","紧急":"priority-label-urgent","高":"priority-label-high","中":"priority-label-middle","低":"priority-label-low","无关紧要":"priority-label-nice-to-have"},g="priority-label-empty priority-label- priority-label--- priority-label-urgent priority-label-high priority-label-4 priority-label-middle priority-label-medium priority-label-3 priority-label-low priority-label-2 priority-label-nice-to-have priority-label-insignificant priority-label-1";d=c[b],$(f).removeClass(g),$(f).removeClass("editable-empty-label"),$(f).addClass(d)}function severity_call_back(f){var d,b=$(f).attr("data-editable-value"),c={"":"severity-label-empty","--":"severity-label-empty",fatal:"severity-label-fatal",serious:"severity-label-serious",normal:"severity-label-normal",prompt:"severity-label-prompt",advice:"severity-label-advice","致命":"severity-label-fatal","严重":"severity-label-serious","一般":"severity-label-normal","提示":"severity-label-prompt","建议":"severity-label-advice"},g="severity-label-empty severity-label- severity-label--- severity-label-fatal severity-label-serious severity-label-4 severity-label-normal severity-label-3 severity-label-prompt severity-label-2 severity-label-advice severity-label-1";d=c[b],$(f).removeClass(g),$(f).addClass(d)}function modify_title(a){rememberTitle=a,document.title=a}function identityCodeValid(k){var w,q,j={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},g=k.substr(6,4)+"/"+Number(k.substr(10,2))+"/"+Number(k.substr(12,2)),b=new Date(g),f=b.getFullYear()+"/"+Number(b.getMonth()+1)+"/"+Number(b.getDate()),h=(new Date).getTime(),x=b.getTime(),m=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],p=["1","0","X","9","8","7","6","5","4","3","2"],v=0;if(!/^\d{17}(\d|x)$/i.test(k)){return !1}if(void 0===j[k.substr(0,2)]){return !1}if(x>=h||g!==f){return !1}for(w=0;17>w;w++){v+=k.substr(w,1)*m[w]}return q=p[v%11],q!==k.substr(17,1)?!1:!0}function array_unique(f){for(var d={},b=[],c=0;c<f.length;c++){d[f[c]]||(d[f[c]]=!0,b.push(f[c]))}return b}function if_mindmap_illegal_char(f){for(var d=["~","!","@","#","$","%","^","&","*","=","?","/","|",'"',"\\"],b=0,c=!1;b<d.length;b++){if(-1!=f.indexOf(d[b])){c=!0;break}}return c}function isEmptyObject(b){for(var a in b){return !1}return !0}function escEvent(){$(document).keydown(function(d){var c=$(".treechooser-filter").is(":focus"),b=$(".treechooser-filter").val();27==d.keyCode&&(c?""==b?parent.TFL.dialog.close():$(".treechooser-filter").val(""):parent.TFL.dialog.close())})}function ajax_save_workspace_switch(f,d,b,c){var g=f+d;$.post(g,{ajax_sw_name:d,ajax_sw_value:b},function(a){return 0==a.status?void TFL.tips.showFlash(c[d].failed):void (b?TFL.tips.showFlash(c[d].enable_success):TFL.tips.showFlash(c[d].cancle_success))},"json")}function strReplaceAll(d,c,b){return d.replace(new RegExp(c,"gm"),b)}function isContainsLetterNumberOrdot(b){var a=/[A-Za-z0-9_\.]/;return a.test(b)?!0:!1}function switchNewIteration(a){$.cookie("iteration_type_"+a,"card_view",{expires:30,path:"/"}),location.href=_base+_workspace_pretty_name+"/prong/iterations/card_view"}function switchOldIteration(a){$.cookie("iteration_type_"+a,"index",{expires:30,path:"/"}),location.href=_base+_workspace_pretty_name+"/prong/iterations/index"}function getAvatorListAttr(k){var u,q,j,g,b,f,h,v,m,p;u=void 0!=k.workspaceId?k.workspaceId:0,void 0==k.users||"--"==k.users?q="":(q=k.users,q instanceof Array&&(q=q.join(";"))),void 0!=k.size?(size=k.size,j=g=k.size):(void 0!=k.width&&(j=k.width),void 0!=k.height&&(g=k.height)),b=void 0!=k.autoSubmit?k.autoSubmit:!0,f=void 0!=k.editable?k.editable:!0,imgBaseUrl=void 0!=k.imgBaseUrl?k.imgBaseUrl:fileBasePath+u+"/users/avatar/",showAddBtn=void 0!=k.showAddBtn?k.showAddBtn:!1,m=void 0!=k.initText?k.initText:!1,h=isCloud?"":fileBasePath+"img/avatar.jpg",v=[],v["data-avatar-imgBaseUrl"]=imgBaseUrl,v["data-avatar-defaultImg"]=h,v["data-avatar-editAuthority"]=f,v["data-avatar-users"]=q,v["data-avatar-imgWidth"]=j,v["data-avatar-imgHeight"]=g,v["data-avatar-autosubmit"]=b,v["data-avatar-showAddBtn"]=showAddBtn,v["data-avatar-initText"]=m,f&&b&&(v["data-avatar-sendkeyname"]=k.sendKey,v["data-avatar-sendparams"]=void 0!=k.sendParams?encodeURIComponent(JSON.stringify(k.sendParams)):"",v["data-avatar-sendUrl"]=k.updateUrl),void 0!=k.hiddenName&&(v["data-avatar-hiddenName"]=k.hiddenName),void 0!=k.avatarOffsetLeft&&(v["data-avatar-offsetleft"]=k.avatarOffsetLeft),void 0!=k.avatarOffsetTop&&(v["data-avatar-offsettop"]=k.avatarOffsetTop),void 0!=k.skin&&(v["data-avatar-skin"]=k.skin),p="";for(key in v){p+=key+'="'+v[key]+'" '}return p}function replaceImgTag(d){var c=$("#description_div").width(),b=fileBasePath+"compress/compress_img/"+c;return _replaceImgTagWithCompressPath(d,b,c)}function _replaceImgTagWithCompressPath(h,k,j){var g,d,b,c=/<img[^>]*?src=\"(?:^data)?([^>\"]*?\.(jpg|jpeg|gif))\"[^>]*?>/gi,f="<img \n	onload=\"\n	var width = $(this).width();\n	$(this).css('max-width', '"+j+'px\');\n	$(this).click(function(){\n		var original_src = $(this).attr(\'original_src\');\n		window.open(original_src);\n	});"\n title="点击看原图" href="ORIGINAL_SRC_PATH" class="compress" src="'+k+'?src=COMPRESS_SRC_PATH" original_src="ORIGINAL_SRC_PATH" style="max-width:'+j+'px;COMPRESS_STYLE_STR"/>',m=h.replace(c,function(p,l){var i=l;if(-1!=i.toLowerCase().indexOf("tfl/img/emoticons/")){return p}var r,n,q=/^http(s?):\/\//,u=new RegExp(_base,"g");return q.test(i)?r=i.replace(u,fileBasePath):(r=fileBasePath+i,r=r.replace(/([^:])\/{2,}/g,"$1/")),i=htmlspecialchars_encode(i),n=f.replace(/COMPRESS_SRC_PATH/g,i),n=n.replace(/ORIGINAL_SRC_PATH/g,r),g=p.match(/style=['\"]([^'\"]+)['\"]/i)?p.match(/style=['\"]([^'\"]+)['\"]/i):[],0!=g.length?(n.replace(/\s+width=['\"]([0-9]+)['\"]/i,""),n.replace(/\s+height=['\"]([0-9]+)['\"]/i,""),n=n.replace(/COMPRESS_STYLE_STR/g,g[1])):(d=p.match(/\s+width=['\"]([0-9]+)['\"]/i)?p.match(/\s+width=['\"]([0-9]+)['\"]/i)[1]:[],b=p.match(/\s+height=['\"]([0-9]+)['\"]/i)?p.match(/\s+height=['\"]([0-9]+)['\"]/i)[1]:[],g="width:"+d+"px;height:"+b+"px;",n=n.replace(/COMPRESS_STYLE_STR/g,g)),n});return""==m||void 0==m||null==m?h:(h=m,c=/<img[^>]*?src=\"(?:^data)?([^\">]*?\.(png|bmp))\"[^>]*?>/gi,m=h.replace(c,function(p,l){var i,r,n=l,q=/^http(s?):\/\//,u=new RegExp(_base,"g");return i=q.test(n)?n.replace(u,fileBasePath):fileBasePath+n,n=htmlspecialchars_encode(n),r=f.replace(/COMPRESS_SRC_PATH/g,n),r=r.replace(/ORIGINAL_SRC_PATH/g,i),g=p.match(/style=['\"]([^'\"]+)['\"]/i)?p.match(/style=['\"]([^'\"]+)['\"]/i):[],0!=g.length?(r.replace(/\s+width=['\"]([0-9]+)['\"]/i,""),r.replace(/\s+height=['\"]([0-9]+)['\"]/i,""),r=r.replace(/COMPRESS_STYLE_STR/g,g[1])):(d=p.match(/\s+width=['\"]([0-9]+)['\"]/i)?p.match(/\s+width=['\"]([0-9]+)['\"]/i)[1]:[],b=p.match(/\s+height=['\"]([0-9]+)['\"]/i)?p.match(/\s+height=['\"]([0-9]+)['\"]/i)[1]:[],g="width:"+d+"px;height:"+b+"px;",r=r.replace(/COMPRESS_STYLE_STR/g,g)),r}),""==m||void 0==m||null==m?h:m)}var _arrStaffs,_arrAdgroups;String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};var Class=function(b){var a=function(){return null!==arguments[0]&&this.initialize&&"function"==typeof this.initialize?this.initialize.apply(this,arguments):this};return $.extend(a,this),a.prototype=b,a.constructor=Class,a.prototype.base=function(){return this.prototype.initialize.apply(this,arguments)},a};Class.prototype.extend=function(a){this.prototype=$.extend({},a.prototype,this.prototype),this.prototype.prototype=a.prototype,this.prototype.baseclass=a.prototype};var TapdEvent={Category_tree_reload_complete:"category_tree_reload_complete",Category_clicked:"category_clicked",Stories_tree_table_updated:"stories_tree_table_updated",Export_tapdbox_url_updated:"export_tapdbox_url_updated",Iteration_content_loaded:"iteration_content_loaded",Iteration_loaded_by_url:"iteration_loaded_by_url"},confirm_dialog=function(f,d,b,c){TFL.confirm.show(f,d,b,c)},customBtn={do_disable:function(){},do_able:function(){}},app_scroller={init:function(g){var d={panelWidth:0},b=jQuery.extend(d,g),c=b.scroller,j=b.panel.length;c.width(18*j);for(var f=0,h="";j>f;f++){h+="<a class='app_dot' href='javascript:;' index='"+f+"'></a>"}c.find("p").html(h),c.find(".app_dot").bind("click",function(){app_scroller.doscroll($(this).attr("index"),b)})},doscroll:function(f,d){var b=d.tagetObj;b.stop();var c=d.panelWidth,g=-c*f;b.animate({left:g},500),d.scroller.find(".app_ontag").animate({left:18*f+8},500)}};TFL.widget("funToggle",{init:function(){$("body").delegate(".fun-toggle","click",TFL.funToggle._bind)},_bind:function(){var a=$(this);a.hasClass("disabled")||TFL.funToggle.slide(a)},slide:function(b){var a=$(b);a.hasClass("on")?a.animate({"background-position":"100% 0%"},500).addClass("off").removeClass("on"):a.animate({"background-position":"0% 0%"},500).addClass("on").removeClass("off")}},!0),TFL.widget("funToggleSmall",{init:function(){$("body").delegate(".fun-toggle-small","click",TFL.funToggleSmall._bind)},_bind:function(){var a=$(this);a.hasClass("disabled")||TFL.funToggleSmall.slide(a)},slide:function(b){var a=$(b);a.hasClass("on")?a.animate({"background-position":"100% 0%"},500).addClass("off").removeClass("on"):a.animate({"background-position":"0% 0%"},500).addClass("on").removeClass("off")}},!0),TFL.widget("tabOverflow",{allLi:null,totalWidth:0,widthArr:[],init:function(g,d,b,c){var j=$(g),f=$(d),h=void 0==arguments[3]?!0:arguments[3];this.allLi=j.find("> li"),this.allLi.each(function(){var a=$(this).outerWidth(!0);TFL.tabOverflow.totalWidth+=a,TFL.tabOverflow.widthArr.push(a)}),this._calculation(j,f,b),h&&$(window).resize(function(){TFL.tabOverflow._calculation(j,f,b)})},_calculation:function(k,w,q){var j=w.width(),g=100,b=0,f=0,h=20,x=$("#tab-overflow");if($(this.widthArr).each(function(c,a){return b+=a,b+g>j&&!f?(f=c,!1):void 0}),x.length){if(k.find("> li").index(x)==f){return}var m=x.find("li");m.insertAfter(x)}if(this.totalWidth+h>j){var p;p=x.length?x:$("<li id='tab-overflow' class='dropdown' data-dropdown='click'><a class='dropdown-toggle'>"+q+" <i class='arr'></i></a><div class='dropdown-menu'><ul></ul><div class='dropdown-shadow'></div></div></li>"),p.insertAfter(this.allLi.eq(f-1));var v=p.nextAll("li");p.find("ul").append(v)}else{x.remove()}}}),TFL.widget("Util",{array_keys:function(d){var c=new Array;for(var b in d){c.push(b)}return c},merge:function(f,d){var b=f;for(var c in d){b[c]=d[c]}return b},escapeHtml:function(d){var c=document.createElement("div"),b=document.createTextNode(d);return c.appendChild(b),c.innerHTML}}),TFL.widget("listTable",{opts:{},$tableWrap:null,$batchMenu:$(),$batchMenuBackup:null,listAction:function(d){var c=this,b={wrap:"div.list-content-wrap",ddm:".dropdown-operation",checkbox:".flag_area input[type=checkbox]",checkAll:"#check_all",batchMenuTempl:"#menu_template .dropdown-operation",batchEdit:!0};return c.opts=$.extend({},b,d),c.$tableWrap=$(c.opts.wrap),"true"==c.$tableWrap.attr("data-initListAction")?!1:(c.$tableWrap.delegate(c.opts.ddm,"click",function(a){c._clickMenu(this,a)}),c.$tableWrap.delegate("tr","mousemove",function(a){$(this).find(c.opts.ddm).removeClass("fixie").addClass("fixie")}),$(document).click(function(a){c._clickMenu(this,a)}),c.opts.batchEdit&&c._initBatch(),void c.$tableWrap.attr("data-initListAction","true"))},_initBatch:function(){var a=this;a.$batchMenu=$(a.opts.batchMenuTempl).find("div.dropdown-menu"),a.$batchMenuBackup=a.$batchMenu.clone(),this._insertMenuTitle(),a.$tableWrap.delegate("a.batch-dropdown-toggle","mousedown",function(){a.toggleBatchMenu(this)}),a.$tableWrap.delegate(a.opts.checkbox,"click",function(){a.checkItem(this)}),$(document).delegate(a.opts.checkAll,"click",function(){a._checkAll(this)}),$(document).bind("dropdownopen",function(b){$(b.target).parent(".batch-dropdown-operation").length&&a._updateCount(b.target)}),a._initChecked()},_initChecked:function(){var a=this;$(a.opts.checkbox).filter(":checked").each(function(){a.checkItem(this)})},_clickMenu:function(d,c){var b=this;$(c.target).closest(b.opts.ddm).length?$(d).closest("tr").addClass("click-tr").siblings().removeClass("click-tr"):b.$tableWrap.find("tr.click-tr").removeClass("click-tr")},checkItem:function(d){var c=this,b=$(d).closest("tr").addClass("checked-tr").find("td.list-action>div");$(d).prop("checked")?c._initBatchMenu(b):$(d).closest("tr").removeClass("checked-tr"),b.find("div.dropdown-operation").removeClass("fixie").addClass("fixie"),b=null},_checkAll:function(b){var a=this;$(b).prop("checked")?$(a.opts.checkbox+"[class!=no-permission]").prop("checked",!0).each(function(){a.checkItem(this)}):$(a.opts.checkbox).prop("checked",!1).each(function(){a.checkItem(this)})},_insertMenuTitle:function(){var a='<li class="title counter"><span>批量处理(选中1项)</span></li>';this.$batchMenu.prepend(a)},_updateCount:function(d){var b=t("num_selected_for_batch_action"),c=$(this.opts.checkbox).filter(":checked").length;$(d).find("li.title span").html(b.replace("%s",c))},_initBatchMenu:function(d){var c=this;if(d.find(".batch-dropdown-operation").length||!$(c.opts.batchMenuTempl).length){return !1}if(isLego()){var b='<div class="dropdown-operation batch-dropdown-operation">	<div class="dropdown" data-dropdown="click">	<a class= "dropdown-toggle batch-dropdown-toggle" href="javascript:;" style="border: 0;background: transparent;"><i class="font font-more"></i></a>	</div></div>'}else{var b='<div class="dropdown-operation batch-dropdown-operation">	<div class="dropdown" data-dropdown="click">	<a class= "ico-gear-down dropdown-toggle batch-dropdown-toggle" href="javascript:;"></a>	</div></div>'}d.append(b)},toggleBatchMenu:function(a){this.$batchMenu.length||(this.$batchMenu=this.$batchMenuBackup.clone()),$(a).parent().append(this.$batchMenu)}}),TFL.widget("autoSave",{auto_save:function(g){var d={auto_save_url:"",entity_type:"Story",description_id:"StoryDescription",form_id:"FormStory"};if(g=$.extend(d,g),formChangeTips_ref.isChange){var b=$('input[name="data[is_editor_or_markdown]"]').val();if(2==b&&TFL.markdown&&TFL.markdown.getInstance(g.description_id)){var c=TFL.markdown.getInstance(g.description_id);c.beforeFormSubmit(),c.transWikiToHtml()}else{var h=get_richeditor_content(g.description_id);$("#"+g.description_id).val(h)}var f=$("#"+g.form_id);f.ajaxSubmit({dataType:"text",type:"post",url:g.auto_save_url,success:function(m,l){var j=$("<div>"+m+"</div>").find("#result_link");if("failed"!=j.text()){$(".draft-link").show();var k=j.attr("draft_id");if(0==$("#draft_id").length){var q=$('<input id="draft_id" style="display:none" value="" name="data[draft_id]" />');f.append(q);var p=parseInt($("#draft_count").text())+1;$("#draft_count").text(p)}$("#draft_id").val(k),formChangeTips_ref.isChange=!1,show_flash_message(m)}}})}}}),TFL.widget("scrollSpy",{run:function(d,c,b){d.size()&&setTimeout(function(){function a(){var e=$(document).height(),h=$(document).scrollTop(),f=$(window).height(),g=b;d.hasClass(c)&&(g=30),e-f-h>g?d.addClass(c):d.removeClass(c)}a(),$(window).scroll(a),$(window).resize(a)},150)}}),$(function(){TFL.scrollSpy.run($(".form-action-spy"),"form-action",106)}),TFL.timer=TFL.timer||[],function(a){a.fn.placeholder=function(){return"placeholder" in document.createElement("input")?a(this):a(this).each(function(){var c=a(this),b=a.trim(c.attr("placeholder"))||"";b&&""===c.val()&&(c.val(b),c.addClass("placeholder")),c.focus(function(){var d=a.trim(c.val());(""===d||d===b)&&c.removeClass("placeholder").val("")}).blur(function(){var d=a.trim(c.val());(""===d||d===b)&&c.addClass("placeholder").val(b)})})},a.fn.prettyPlaceHolder=function(){var d=a(this).prev("label"),b=a(this),c=function(){""==b.val()?d.show():d.hide()};c(),b.bind("input propertychange",c)}}(jQuery);var serverTip={closeTip:function(d,c){d||console.log("error: no id!");var b=_base+_workspace_id+"/usernews/disable_new/"+d;$.get(b,function(a){c&&c(a)})},getTip:function(d,c){d||console.log("error: no id!");var b=_base+_workspace_id+"/usernews/get_user_new_tip/"+d;$.get(b,function(a){c&&c(a)},"json")}};if(function(a){a.fn.intinput_validation=function(){a(this).css("ime-mode","disabled"),a(this).keydown(function(b){int_validation_event(b,a(this))}).keyup(function(b){a(this).val(a(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).bind("paste",function(){return !1})},a.fn.intinput_validation_multi=function(){a(this).find("input[intinput]").css("ime-mode","disabled"),a(this).delegate("input[intinput]","keydown",function(b){int_validation_event(b,a(this))}).delegate("input[intinput]","keyup",function(b){a(this).val(a(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).delegate("input[intinput]","paste",function(b){return !1})}}(jQuery),"undefined"==typeof fail_function){var fail_function=function(b,a){TFL.tips.showFlash(b,!0,3000)}}document.addEventListener&&(document.addEventListener("error",function(b){var a=$(b.target);a.hasClass("common-avatar-img")&&("undefined"!=typeof isCloud&&1==isCloud?(a.next(".avatar-text-default").show(),a.remove()):"undefined"!=typeof isExternal&&1==isExternal?b.target.src=_base+"img/avatar.jpg":b.target.src="http://dayu.oa.com/avatar/default.png")},!0),document.addEventListener("load",function(d){var c=$(d.target);if(c.hasClass("common-desc-img")&&!c.hasClass("gallery")){var b=(c.width(),$("#description_div").width());c.css("max-width",b),c.click(function(){var a=c.attr("original_src");window.open(a)})}},!0)),$(document).ready(function(){if($("body").bind("show_flash_message",function(a){TFL.tips.showFlash(a.msg)}),autofocus(),setPageConfigPosition(),$(document).bind("tuiFilterOpen",setPageConfigPosition).bind("tuiFilterClose",setPageConfigPosition),simplePager(),dropAnchor("#story-worktable-list tr,#bug-worktable-list tr,#task-worktable-list tr, #story_list_content tr,#task_table tr, #bug_list_content tr, #tcase_list_table tr, #plan_list_table tr, #form_list tr, #stories_tasks_content tr, #bug_content tr, #bugquery_table tr, [id^=iteration_table_] tr, #releases-list tr,#tobject-instance-list tr,#launch-worktable-list tr"),fixZindex("#stories_tree_table .table-action-top div.abs_right"),scrollingTag(26,"scrolltop"),responseMenu(1280,"minimenu"),noH5Validate(),disabledEnterSubmit(".editform"),inviteCheckbox(),isLego()){var d=function(){$("a.corner-marker").attr("target","_self"),$("body").delegate(".table td a, .g_table td a, #base_information a","mouseenter",function(){if($(this).closest("#wiki_content").length){return !0}if($(this).hasClass("no_blank")){return !0}if($(this).parents(".dropdown-menu").length>0){var f=$.trim($(this).text());if("编辑"!=f&&"Edit"!=f&&"edit"!=f&&"创建子需求"!=f&&"Add Child"!=f&&"创建需求"!=f&&"Add Story"!=f){return !0}}if($(this).is('[class*="tapd-btn"]')){return !0}var a=$.trim($(this).attr("href"));return a&&"#"!=a&&"javascript:;"!=a?"undefined"!=typeof _is_wework_desktop&&_is_wework_desktop?!0:void ("_blank"!=$(this).attr("target")&&$(this).attr("target","_blank")):!0})};d(),$(document).ajaxComplete(function(){d()})}("undefined"!=typeof isDev||"1"===isDev)&&tapdDevTool(),TFL.use("HeaderFloat",function(){TFL.HeaderFloat.init({ajax_table:!1})});var c=document.title;try{"undefined"==typeof isChangeTitle&&document.attachEvent("onpropertychange",function(){document.title!=c&&(document.title=c)})}catch(b){}}),String.prototype.sub=function(f){var d=/[^\x00-\xff]/g;if(this.replace(d,"mm").length<=f){return this.toString()}for(var b=Math.floor(f/2),c=b;c<this.length;c++){if(this.substr(0,c).replace(d,"mm").length>=f){return this.substr(0,c)}}return this.toString()};var urlHash={_setHash:function(d){var c,b=(d.length,"#");for(c in d){d.hasOwnProperty(c)&&(b+=c+"="+d[c]+"&")}b=b.substring(0,b.length-1),window.location.hash=b},_parseTopHash:function(){var g=window.location.hash;if(0!==g.indexOf("#")){return{}}for(var d=g.split("#")[1].split("&"),b=d.length,c={},j=0;b>j;j++){var f=d[j].split("=")[0],h=d[j].split("=")[1];f&&h&&(c[f]=h)}return c},getHash:function(b){var a=this._parseTopHash();return a[b]},setHash:function(f,d){var b=this._parseTopHash();d?b[f]=d:delete b[f];var c=location.href.replace("/#"+f+"=[^&#=]*/","");c=c.replace("/&"+f+"=[^&#=]*/",""),this._setHash(b)},shiftHashToParam:function(url,key){var hashValue=this.getHash(key);if(hashValue){var re=eval("/("+key+"=)([^&#]*)/gi"),hashPart="";-1!=url.indexOf("#")&&(hashPart=url.substr(url.indexOf("#")),url=url.substr(0,url.indexOf("#"))),url=url.match(re)?url.replace(re,key+"="+hashValue):-1!=url.indexOf("?")?url.replace("?","?"+key+"="+hashValue):url+"?"+key+"="+hashValue,hashPart.match(re)&&(hashPart=hashPart.replace(re,key+"="+hashValue)),url+=hashPart}return url}};jQuery.cookie=function(k,j,f){if("undefined"==typeof j){var g=null;if(document.cookie&&""!=document.cookie){for(var b=document.cookie.split(";"),w=0;w<b.length;w++){var d=jQuery.trim(b[w]);if(d.substring(0,k.length+1)==k+"="){g=decodeURIComponent(d.substring(k.length+1));break}}}return g}f=f||{},null===j&&(j="",f.expires=-1);var v="";if(f.expires&&("number"==typeof f.expires||f.expires.toUTCString)){var x;"number"==typeof f.expires?(x=new Date,x.setTime(x.getTime()+24*f.expires*60*60*1000)):x=f.expires,v="; expires="+x.toUTCString()}var q=f.path?"; path="+f.path:"",l=f.domain?"; domain="+f.domain:"",h=f.secure?"; secure":"";document.cookie=[k,"=",encodeURIComponent(j),v,q,l,h].join("")};