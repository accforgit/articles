TFL.widget("loading",{init:function(e,t){if(TFL.use(TFL.path+"css/tfl-loading.css"),"object"==typeof e)this._targetElement=e;else if("string"==typeof e){var s=document.querySelectorAll(e);if(!s)throw new Error("There is no element with given selector.");this._targetElement=s}else{if($("body").hasClass("iframe-body"))return!1;this._targetElement=document.body}"undefined"==typeof window._progressjsId&&(window._progressjsId=1),"undefined"==typeof window._progressjsIntervals&&(window._progressjsIntervals={});var r={theme:"lego",overlayMode:!1,considerTransition:!0};this._options=$.extend(!0,{},r,t)},begin:function(){"undefined"!=typeof this._targetElement&&(this._createContainer(),this._setProgress())},autoIncrease:function(e,t){if("undefined"!=typeof this._targetElement){var s=parseInt(this._targetElement.getAttribute("data-progressjs"));"undefined"!=typeof window._progressjsIntervals[s]&&clearInterval(window._progressjsIntervals[s]);var r=this;window._progressjsIntervals[s]=setInterval(function(){r._increasePercent(e)},t)}},end:function(){if("undefined"!=typeof this._targetElement){var e=parseInt(this._targetElement.getAttribute("data-progressjs")),t=this._targetElement,s=this._getPercentElement(t);if(s){var r=parseInt(s.style.width.replace("%","")),n=1;if(100>r&&(this._setPercentFor(t,100),n=500),function(e,t){setTimeout(function(){e.parentNode.className+=" progressjs-end",setTimeout(function(){e.parentNode.parentNode&&e.parentNode.parentNode.removeChild(e.parentNode),t.removeAttribute("data-progressjs")},1e3)},n)}(s,t),window._progressjsIntervals[e])try{clearInterval(window._progressjsIntervals[e]),window._progressjsIntervals[e]=null,delete window._progressjsIntervals[e]}catch(o){}}}},_increasePercent:function(e){var t=this._targetElement;if(null!=t.getAttribute("data-progressjs")){var s=this._getPercentElement(t),r=parseInt(s.style.width.replace("%",""));r&&90>r&&this._setPercentFor(t,r+(e||1))}},_createContainer:function(){if(0==$(".progressjs-container").length){var e=document.createElement("div");e.className="progressjs-container",document.body.appendChild(e)}},_setProgress:function(){var e=this._targetElement;if(null==e.getAttribute("data-progressjs")){var t=this._getOffset(e);e.setAttribute("data-progressjs",window._progressjsId);var s=document.createElement("div");s.className="progressjs-progress progressjs-theme-"+this._options.theme,"body"===e.tagName.toLowerCase()?s.style.position="fixed":s.style.position="absolute",s.setAttribute("data-progressjs",window._progressjsId);var r=document.createElement("div");r.className="special-progressjs-inner",r.style.width="1%";var n=document.createElement("div");n.className="progressjs-inner";var o=document.createElement("div");o.className="progressjs-percent",o.innerHTML="1%",n.appendChild(o),this._options.overlayMode&&"body"===e.tagName.toLowerCase()?(s.style.left=0,s.style.right=0,s.style.top=0,s.style.bottom=0):(s.style.left=t.left+"px",s.style.top=t.top+"px",s.style.width=t.width+"px",this._options.overlayMode&&(s.style.height=t.height+"px")),s.appendChild(r),s.appendChild(n);var i=$(".progressjs-container")[0];i.appendChild(s),this._setPercentFor(e,1),++window._progressjsId}},_getOffset:function(e){var t={};"body"===e.tagName.toLowerCase()?(t.width=e.clientWidth,t.height=e.clientHeight):(t.width=e.offsetWidth,t.height=e.offsetHeight);for(var s=0,r=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)s+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;return t.top=r,t.left=s,t},_setPercentFor:function(e,t){if(t>=100&&(t=100),null!=e.getAttribute("data-progressjs")){var s=this;setTimeout(function(){var r=s._getPercentElement(e);if("undefined"!=typeof r){r.style.width=parseInt(t)+"%";var n=parseInt(t)+.5,o=s._getSpecialPercentElement(e);o.style.width=n+"%";var r=$(".progressjs-percent")[0],i=parseInt(r.innerHTML.replace("%",""));!function(e,t,s){function r(e,t,s){var i=Math.abs(t-s);3>i?o=30:20>i?o=20:intervanIn=1,t-s!=0&&(e.innerHTML=(n?++t:--t)+"%",setTimeout(function(){r(e,t,s)},o))}var n=!0;t>s&&(n=!1);var o=10;r(e,t,s)}(r,i,parseInt(t))}},50)}},_getPercentElement:function(e){var t=parseInt(e.getAttribute("data-progressjs"));return $('.progressjs-container > .progressjs-progress[data-progressjs="'+t+'"] > .progressjs-inner')[0]},_getSpecialPercentElement:function(e){var t=parseInt(e.getAttribute("data-progressjs"));return $('.progressjs-container > .progressjs-progress[data-progressjs="'+t+'"] > .special-progressjs-inner')[0]}},!0);